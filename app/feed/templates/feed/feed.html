<!-- check out the this linke for noticle post function
https://demos.creative-tim.com/argon-dashboard-pro/docs/plugins/quill.html -->
<!-- 
this link for tag option for the inquiry post and noticle post
https://demos.creative-tim.com/argon-dashboard-pro/docs/plugins/tags.html -->

{% extends 'base-authpage.html' %}
{% load static %}
{% load widget_tweaks %}
{% block navbar %}
{% include 'include/nav-authpage.html' %}
{% endblock %}


{% block style %}
<style>
  .card-zoom[data-animation=zooming] {
      transition: all .3s cubic-bezier(.2,1,.22,1);
      -webkit-transition: all .3s cubic-bezier(.2,1,.22,1);
  }
  .card-zoom[data-animation=zooming]:hover {
  transform: scale(1.07);
  -webkit-transform: scale(1.07);
  z-index: 2;
  }
  .sidebar {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    /* z-index: 100; */
    padding: 96px 0 0 8%;
    /* box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1); */
  }

  .upload-btn-wrapper {
    position: relative;
    overflow: hidden;
    display: inline-block;
  }

  .upload-btn-wrapper input[type=file] {
    font-size: 100px;
    position: absolute;
    left: 0;
    top: 0;
    opacity: 0;
  }
</style>
{% endblock %}

{% block scripts %}
<script>
  var reader = new FileReader();
  
  function readURL(input) {
    if (input.files && input.files[0]) {
      reader.onload = function(e) {
        $('#image-preview-container').attr('class', 'd-block');
        $('#post-preview-image').attr('src', e.target.result);
      }
      
      reader.readAsDataURL(input.files[0]); // convert to base64 string
    }
  }

  $("#post-image-input").change(function() {
    readURL(this);
  });
</script>
{% endblock %}

{% load tz %}
{% block content %}
<div class="wrapper">
    <section class="section section-blog-info">
        <!-- side bar -->
        <nav class="col-md-3 d-none d-md-block">
            <div class="sidebar-sticky sidebar">
              <ul class="nav flex-column">
                <li class="nav-item">
                  <a class="nav-link active" href="{% url 'people:people' %}">
                      <i class="fa fa-users"></i>
                      People
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{% url 'inquiry:inquiry' %}">
                    <span>
                      <i class="fa fa-question"></i>
                    </span>
                    Questions
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="popover" data-placement="top" data-content="Oops! This function is coming soon!">
                      <i class="ni ni-collection"></i>
                      Noticles
                  </a>
                </li>
                
                <!-- <li class="nav-item">
                  <a class="nav-link" href="#" data-toggle="popover" data-placement="top" data-content="Oops! This function is coming soon!">
                    <span>
                      <i class="fa fa-comments"></i>
                    </span>
                    Messages
                  </a>
                </li> -->
              </ul>
            </div>
        </nav>

        <!-- post area -->
        <div class="container">
          <div class="row">
            <div class="col-md-8 mx-auto">
              <!-- Tabs with icons -->
              <div class="nav-wrapper mt-3">
                <ul class="nav nav-pills nav-fill flex-column flex-md-row" id="tabs-icons-text" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link mb-sm-3 mb-md-0 active" id="tabs-icons-text-1-tab" data-toggle="tab" href="#tabs-icons-text-1" role="tab" aria-controls="tabs-icons-text-1" aria-selected="true">
                      <i class="ni ni-cloud-upload-96 mr-2"></i>
                      Post
                    </a>
                  </li>
                  <li class="nav-item">
                    <!-- <a class="nav-link mb-sm-3 mb-md-0" id="tabs-icons-text-2-tab" data-toggle="tab" href="#tabs-icons-text-2" role="tab" aria-controls="tabs-icons-text-2" aria-selected="false"> -->
                    <a class="nav-link mb-sm-3 mb-md-0" href="#" data-toggle="popover" data-placement="top" data-content="Oops! This function is coming soon!">
                      <i class="ni ni-collection mr-2"></i>
                      Noticle
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link mb-sm-3 mb-md-0" id="tabs-icons-text-3-tab" data-toggle="tab" href="#tabs-icons-text-3" role="tab" aria-controls="tabs-icons-text-3" aria-selected="false">
                      <i class="fa fa-question mr-2"></i>
                      Ask
                    </a>
                </li>
                </ul>
              </div>
              <div class="card shadow">
                <div class="card-body">
                  <div class="tab-content" id="myTabContent">
                    <!-- Post -->
                    <div class="tab-pane fade active show" id="tabs-icons-text-1" role="tabpanel" aria-labelledby="tabs-icons-text-1-tab">
                      <form action="" method="POST" enctype="multipart/form-data">
                      {% csrf_token %}
                        <div class="media align-items-center">
                          <img alt="Image placeholder" class="avatar avatar-lg rounded-circle mb-4" src="{% static 'img/faces/team-3.jpg' %}">
                          <div class="media-body">
                            {% render_field new_post_form.body class+="form-control" placeholder="Write your post" rows="3" %}
                          </div>
                        </div>
                        <div id="image-preview-container" class="d-none">
                          <img id="post-preview-image" class="w-100 h-100">
                        </div>
                        <div class="text-right ml-auto">
                          <div class="btn p-0 upload-btn-wrapper align-middle">
                            <button type="button" class="btn mr-0 btn-icon rounded">
                              <span class="btn-inner--icon icon-big"><i class="fa fa-image"></i></span>
                            </button>
                            {% render_field new_post_form.image id="post-image-input" %}
                          </div>
                          <button type="submit" class="btn btn-sm btn-primary btn-icon">
                            <span class="btn-inner--icon icon-big"><i class="ni ni-fat-add"></i></span>
                            <span class="btn-inner--text">Post</span>
                          </button>
                        </div>
                      </form>
                    </div>

                    <!-- Noticle -->
                    <div class="tab-pane fade" id="tabs-icons-text-2" role="tabpanel" aria-labelledby="tabs-icons-text-2-tab">
                      <div class="media align-items-center">
                        <img alt="Image placeholder" class="avatar avatar-lg rounded-circle mb-4" src="{% static 'img/faces/team-3.jpg' %}">
                        <div class="media-body">
                          <form>
                            <textarea class="form-control" placeholder="Markdownx" rows="5"></textarea>
                          </form>
                        </div>
                      </div>
                      <div class="text-right ml-auto">
                        <button type="button" class="btn btn-sm btn-primary btn-icon">
                          <span class="btn-inner--icon icon-big"><i class="ni ni-collection"></i></span>
                          <span class="btn-inner--text">Noticle</span>
                        </button>
                      </div>
                    </div>

                    <!-- Ask -->
                    <div class="tab-pane fade" id="tabs-icons-text-3" role="tabpanel" aria-labelledby="tabs-icons-text-3-tab">
                      <div class="media align-items-center">
                        <img alt="Image placeholder" class="avatar avatar-lg rounded-circle mb-4" src="{% static 'img/faces/team-3.jpg' %}">
                        <div class="media-body">
                          <form>
                            <div class="form-group">
                              <input type="text" class="form-control" placeholder="Title" ></input>
                            </div>
                            <div class="form-group">
                              <textarea class="form-control" placeholder="Write your question" rows="3"></textarea>
                            </div>
                            <div class="form-group bg-secondary">
                              <div class="container mt-1">
                                <div class="row">
                                  <div class="col mt-3 mb-3">
                                    <i class="ni ni-tag"></i>
                                    <span>Tags</span>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-8">
                                    <div class="input-group input-group-alternative mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="ni ni-zoom-split-in"></i></span>
                                      </div>
                                      <input class="form-control" placeholder="Country" type="text">
                                    </div>
                                  </div>  
                                  <div class="col-md-8">
                                    <div class="input-group input-group-alternative mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="ni ni-zoom-split-in"></i></span>
                                      </div>
                                      <input class="form-control" placeholder="School" type="text">
                                    </div>
                                  </div>  
                                  <div class="col-md-8">
                                    <div class="input-group input-group-alternative mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="ni ni-zoom-split-in"></i></span>
                                      </div>
                                      <input class="form-control" placeholder="Course" type="text">
                                    </div>
                                  </div>  
                                  <div class="col-md-8">
                                    <div class="input-group input-group-alternative mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="ni ni-zoom-split-in"></i></span>
                                      </div>
                                      <input class="form-control" placeholder="Year of study abroad" type="text">
                                    </div>
                                  </div>  
                                  <div class="col-md-8">
                                    <div class="input-group input-group-alternative mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="ni ni-zoom-split-in"></i></span>
                                      </div>
                                      <input class="form-control" placeholder="Job before study abroad" type="text">
                                    </div>
                                  </div>  
                                  <div class="col-md-8">
                                    <div class="input-group input-group-alternative mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="ni ni-zoom-split-in"></i></span>
                                      </div>
                                      <input class="form-control" placeholder="Job after study abroad" type="text">
                                    </div>
                                  </div>  
                                  <div class="col-md-8">
                                    <div class="input-group input-group-alternative mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"><i class="ni ni-zoom-split-in"></i></span>
                                      </div>
                                      <input class="form-control" placeholder="Keyword" type="text">
                                    </div>
                                  </div>  
                                </div>  

                              </div>
                            </div>

                          </form>
                        </div>
                      </div>
                      <div class="text-right ml-auto">
                        <button type="button" class="btn btn-sm btn-primary btn-icon">
                          <span class="btn-inner--icon icon-big"><i class="fa fa-question"></i></span>
                          <span class="btn-inner--text">Ask</span>
                        </button>
                      </div>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- feed area -->
          {% if view == 'Post' %}
           <div class="row">
            <div class="col-md-8 mx-auto">

            {% for post in posts %}
              
              <div class="card mt-sm">
                <div class="card-header d-flex align-items-center">
                  <div class="d-flex align-items-center">
                    <a href="javascript:;">
                      <img src="{% static 'img/faces/team-1.jpg' %}" class="avatar">
                    </a>
                    <div class="mx-3">
                      <a href="javascript:;" class="text-dark font-weight-600 text-sm">
                      {% if post.user.basicinfo.name %}
                      {{ post.user.basicinfo.name }}
                      {% else %}
                      @{{ post.user.username }}
                      {% endif %}
                      </a>
                      <small class="d-block text-muted">{{ post.created_at|localtime }}</small>
                    </div>
                  </div>
                  <div class="text-right ml-auto">
                    <button type="button" class="btn btn-sm btn-primary btn-icon">
                      <span class="btn-inner--icon icon-big"><i class="ni ni-fat-add"></i></span>
                      <span class="btn-inner--text">Follow</span>
                    </button>
                  </div>
                </div>
                <div class="card-body">
                  <p class="mb-4">
                  {{ post.body }}
                  </p>
                  {% if post.image %}
                    <img alt="Image placeholder" src={{ post.image.url }} class="img-fluid rounded">
                  {% endif %}
                  <div class="row align-items-center my-3 pb-3 border-bottom">
                    <div class="col-sm-6">
                      <div class="icon-actions">
                        <a href="javascript:;" class="like">
                        {% comment %} <a href="javascript:;" class="like active"> {% endcomment %}
                          <i class="ni ni-like-2"></i>
                          <span class="text-muted">{{ post.likes }}</span>
                        </a>
                        <a href="javascript:;">
                          <i class="ni ni-chat-round"></i>
                          <span class="text-muted">{{ post.replies }}</span>
                        </a>
                        <a href="javascript:;">
                          <i class="ni ni-curved-next"></i>
                          <span class="text-muted">{{ post.shares }}</span>
                        </a>
                      </div>
                    </div>
                    {% comment %} <div class="col-sm-6 d-none d-sm-block">
                      <div class="d-flex align-items-center justify-content-sm-end">
                        <div class="avatar-group">
                          <a href="javascript:;" class="avatar avatar-xs rounded-circle" data-toggle="tooltip" data-original-title="Jessica Rowland">
                            <img alt="Image placeholder" src="{% static 'img/faces/team-1.jpg' %}" class="">
                          </a>
                          <a href="javascript:;" class="avatar avatar-xs rounded-circle" data-toggle="tooltip" data-original-title="Audrey Love">
                            <img alt="Image placeholder" src="{% static 'img/faces/team-2.jpg' %}" class="rounded-circle">
                          </a>
                          <a href="javascript:;" class="avatar avatar-xs rounded-circle" data-toggle="tooltip" data-original-title="Michael Lewis">
                            <img alt="Image placeholder" src="{% static 'img/faces/team-3.jpg' %}" class="rounded-circle">
                          </a>
                        </div>
                        <small class="pl-2 font-weight-bold">and 30+ more</small>
                      </div>
                    </div> {% endcomment %}
                  </div>
                  <!-- Comments -->
                  <div class="mb-1">
                  {% for comment in post.comments.all %}
                    <div class="media media-comment">
                      <img alt="Image placeholder" class="avatar avatar-lg rounded-circle" src="{% static 'img/faces/team-1.jpg' %}">
                      <div class="media-body">
                        <div class="media-comment-text">
                          <div class="mb-2">
                            <a href="" class="text-dark font-weight-600 text-sm">
                            {% if comment.user.basicinfo.name %}
                            {{ comment.user.basicinfo.name }}
                            {% else %}
                            @{{ comment.user }}
                            {% endif %}
                            </a>
                          </div>
                          <p class="text-sm lh-160">{{ comment.body }}</p>
                          <div class="icon-actions">
                            {% comment %} <a href="javascript:;" class="like active"> {% endcomment %}
                            <a href="javascript:;" class="like">
                              <i class="ni ni-like-2"></i>
                              {% if comment.likes is not 0 %}
                                <span class="text-muted">{{ comment.likes }}</span>
                              {% endif %}
                            </a>
                            {% comment %} <a href="javascript:;">
                              <i class="ni ni-curved-next"></i>
                              <span class="text-muted">2 shares</span>
                            </a> {% endcomment %}
                          </div>
                        </div>
                      </div>
                    </div>
                  {% endfor %}
                  <!-- Comment form for a post -->
                    <form action="comment/{{post.id}}" method="POST" enctype="multipart/form-data">
                      {% csrf_token %}
                      <div class="media align-items-center">
                        <img alt="Image placeholder" class="avatar avatar-lg rounded-circle mb-4" src="{% static 'img/faces/team-3.jpg' %}">
                        <div class="media-body">
                          {% render_field comment_form.body class+="form-control" placeholder="Write your post" rows="1" %}
                        </div>
                      </div>
                      <div class="d-none">
                        <img class="w-100 h-100">
                      </div>
                      <div class="text-right ml-auto">
                        {% comment %} <div class="btn p-0 upload-btn-wrapper align-middle">
                          <button type="button" class="btn mr-0 btn-icon rounded">
                            <span class="btn-inner--icon icon-big"><i class="fa fa-image"></i></span>
                          </button>
                          {% render_field comment_form.image id="post-image-input" %}
                        </div> {% endcomment %}
                        <button type="submit" class="btn btn-sm btn-primary btn-icon">
                          <span class="btn-inner--icon icon-big"><i class="ni ni-fat-add"></i></span>
                          <span class="btn-inner--text">Comment</span>
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            {% endfor %}
            </div>
          </div>
          {% elif view == 'Noticle' %}
          <!-- noticle -->
          <div class="row">
            <div class="col-md-8 mx-auto">
              <div class="card card-blog card-background card-grande" data-animation="zooming">
                <div class="full-background" style="background-image: url({% static 'img/sections/unsplashs.jpg' %})"></div>
                <a href="javascript:;">
                  </a><div class="card-body mb-4"><a href="javascript:;">
                    <h2 class="card-title">Miami Vice</h2>
                    <p class="card-description text-white">The simplest visual description uses ordinary words to convey what the writer sees. First he or she must look at the subject – slowly, carefully, and repeatedly, if possible – to identify the parts that make the whole</p>
                    <div class="author">
                      <img src="{% static 'img/faces/team-4.jpg' %}" alt="..." class="avatar">
                      <span class="text-white">by Johanna Zmud</span>
                    </div>
                    <br>
                    </a><a class="btn btn-primary" href="javascript:;">
                      Read more...
                    </a>
                  </div>               
              </div>
            </div>
          </div>
          {% elif view == 'Ask' %}
          <!-- inquiry -->
          <div class="row">
            <div class="col-md-8 mx-auto">
              <div class="card card-blog card-zoom" data-header="pattern" data-animation="zooming">
                <a href="javascript:;">
                  <img class="img pattern rounded" src="{% static 'img/ill/presentation_bg.png' %}">
                </a>
                <div class="card-body">
                  <h6 class="card-category text-danger">
                    <i class="ni ni-badge"></i> Oxford
                  </h6>
                  <h5 class="card-title">
                    <a href="javascript:;">Looking for accommodation</a>
                  </h5>
                  <p class="card-description">
                    Hi, I enrole in Oxford University in 2021. My college is Crist charch. I am looking for afordable accommodations around Oxford...
                  </p>
                  <div class="author">
                    <img src="{% static 'img/faces/team-4.jpg' %}" alt="..." class="avatar">
                    <span>by Johanna Zmud</span>
                  </div>
                </div>
                <div class="card-footer">
                    <div class="icon-actions">
                        <a href="javascript:;" class="like active">
                          <i class="ni ni-like-2"></i>
                          <span class="text-muted">150</span>
                        </a>
                        <a href="javascript:;">
                          <i class="ni ni-chat-round"></i>
                          <span class="text-muted">36</span>
                        </a>
                        <a href="javascript:;">
                          <i class="ni ni-curved-next"></i>
                          <span class="text-muted">12</span>
                        </a>
                    </div>
                </div>
              </div>
            </div>
          </div>
          {% endif %}
        </div>
    </section>
</div>
{% endblock %}
